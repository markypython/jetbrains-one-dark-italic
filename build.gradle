plugins {
    id 'org.jetbrains.intellij' version '0.4.7'
}

ext {
    pluginVersion = '2019.1'
}

group 'com.markskelton'
version System.getenv('GIT_TAG')
println System.getenv('GIT_TAG')

repositories {
    mavenCentral()
}

intellij {
    version pluginVersion
}

patchPluginXml {
    sinceBuild pluginVersion
    // TODO: add change notes
    // changeNotes
}

def getSecret = { String prop, String env ->
    project.hasProperty(prop) ? project.findProperty(prop) : System.getenv(env)
}

publishPlugin {
    username getSecret('publishUsername', 'PUBLISH_USERNAME')
    token getSecret('publishToken', 'PUBLISH_TOKEN')
}
